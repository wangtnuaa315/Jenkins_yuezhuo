第二部分：插件开发与管理规范 (Standardization)
1. 目的与范围
本规范用于统一插件在“开发、集成、使用、授权、运维”的全生命周期标准，确保：
•	可维护：目录结构、编码规范、版本管理一致；
•	可发现：插件在管理页面与模块添加页面分组一致、可检索；
•	可复用：对外暴露的扩展点、配置项、API 约定稳定；
•	可管控：启用/禁用、权限、授权可审计、可追溯；
•	可交付：发布、安装、回滚、兼容性可控。
1.1 术语定义
术语	说明
插件（Plugin）
	以独立包形式交付的功能单元，可包含前端 UI、后端服务、配置与资源。
管理分类	插件管理页面（Plugin Manager）中的分组，用于运维与治理。
使用分类	模块/区块添加（Block/Module Add）中的分组，用于业务装配。
能力插件	提供 AI、音视频、文档等通用能力的插件。
业务插件	承载业务流程/页面/数据模型的插件。
授权（License/Entitlement）	用于控制插件或能力的启用范围、有效期与使用配额的机制。
2. 分组与命名规范（强制）
采用统一的“Taxonomy 元模型”作为三者的单一来源：
•	管理分类（MGMT）：插件在管理页面的治理分组；
•	使用分类（USE）：区块/模块在添加入口的装配分组；
•	类型（TYPE）：插件交付形态（区块/集成/数据/壳/基础设施）；
•	功能域（FUNC）：3-8 位缩写，标识具体能力域；
•	编码（Plugin Code）：由 MGMT + USE + FUNC，可机器校验。
•	落地上，使用package.json约束。

2.1 管理分类（插件管理页面）
管理分类用于插件管理与治理，统一采用以下分组：
管理分类	代码	说明
系统管理	SYS	系统级能力与通用基础组件（认证、通知、安全、监控等）
业务系统	BIZ	业务域功能与页面（项目、工作台、业务流程等）
流媒体平台	STR	与流媒体/音视频平台对接、会议、播放器等
AI相关	AIC	大模型、向量检索、推理、智能体等 AI 能力
知识与语义	KGP	本体建模、语义层、图谱构建/查询等数据智能能力
数字孪生	DTP	三维/仿真/孪生场景、模型联动、可视化引擎封装等
定制类	CUS	客户/场景定制交付的插件
Others	OTH	未命中分组规则时的兜底分类（需尽快治理归类）

2.2 使用分类（模块添加/区块）
使用分类用于“模块添加/区块添加”入口的展示与检索，统一采用以下一级分组：
使用分类（一级）	代码	典型适用插件/区块举例
通用区块	GEN	表格/表单/详情/列表/看板/Markdown/Iframe/操作面板等
视频服务区块	VID	视频播放器/视频会议/视频通信能力/观摩等
语音服务区块	AUD	录音/ASR/TTS/语音服务中心等
文档服务区块	DOC	文档解析/检索/摘要/标注等
AI服务区块	AIM	LLM/多模态/智能体/推理编排等
知识图谱区块	KGP	本体建模/图谱构建/图谱查询等
数字孪生区块	DTP	孪生场景/三维交互/仿真等
管理设置	ADM	仅在系统设置/管理菜单中出现，不在“区块添加”中出现
不对业务暴露	HID	纯后端集成/壳子/基础设施等，不参与装配入口展示
其它区块	OTH	兜底分类
定制化区块	CUS	定制化插件
2.2.1 件管理分组机制与关键字（keywords）规范
插件管理页面的分组由前端分组列表与插件 package.json 的 keywords 精确匹配决定。因此：keywords 必须包含且仅需包含至少一个可命中的分组关键字。
•	keywords 必须与前端PluginManager.tsx keyWordlists 中某项完全一致（区分大小写与空格）。
•	未命中任何分组关键字的插件会被归入 Others（禁止长期停留在 Others）。
•	新增分组时，必须同步更新 keyWordlists，并补全语言包（至少 zh-CN.json）。
目的	强制字段/动作	验收要点
进入管理页面正确分组	package.json: keywords 至少包含 1 个分组关键字	插件在插件管理页分组正确、可筛选
中文显示正确	语言包增加对应翻译键值	管理页面分组与 UI 文案不出现英文原文
避免误分组	keywords 不得随意堆砌多个无关分组	分组具有稳定性与可理解性
具体见：https://q0ej7y1a0g3.feishu.cn/wiki/WgrrwHGjjieHXdkJK0fcoZNknFd
2.3 功能域（FUNC）
FUNC 采用 3-8 位大写字母/数字缩写，建议按“业务/技术域通用缩写表”统一维护（如 LLM、ASR、MEET、PDF、SEM 等）。
•	同一 MGMT + USE + FUNC 下，通过 SEQ（001-999）递增区分不同插件；
•	FUNC 变更视为“产品定义变化”，原则上不变；若能力边界显著变化，按拆分/合并规则处理。

2.3.1 插件命名规则（强制）
插件包名统一采用：
@huaiye/plugin-xxxx（xxxx 使用小写-kebab-case，清晰表达用途）
示例：@huaiye/plugin-ntstream-dbinit、@huaiye/plugin-pdf-viewer-ocr。

2.3.2 插件编码规范（强制）
为支持插件在“开发-交付-运维-授权”的全生命周期治理与统计分析，所有插件必须分配唯一且稳定的插件编码（Plugin Code），并在包元数据与治理清单中登记。
2.3.2.1 编码目标
本编码用于实现以下治理目标：
•	唯一性：同一插件在不同环境/版本中保持编码不变；编码一旦发布原则上不重用。
•	可分类：编码可直接反映管理分类、使用分类、插件类型与功能域，便于检索、统计与审计。
•	可追溯：插件拆分、合并、废弃等变更可通过编码映射关系追踪。
•	可机器校验：可在 CI 中校验编码唯一性、分类合法性以及元数据一致性。
2.3.2.2 编码格式
插件编码格式统一为：
HY-<MGMT>-<USE>-<FUNC>-<SEQ>
字段说明：
•	MGMT：管理分类代码（3 位），见 2.1。
•	USE：使用分类代码（3 位），见 2.2。
•	FUNC：功能域缩写（3-8 位），用于区分同一分类下不同能力域（如 LLM、ASR、MEET、ONTO、SEML）。
•	SEQ：编号，从001开始。
示例1：HY-AIC-AIM-LLM-001（AI相关 / AI服务区块 / 外部服务集成 / LLM / 001）。
2.3.2.3 与包名、关键字（keywords）与治理清单的关系
为兼容现有“插件管理分组机制（keywords 精确匹配）”并支持后续自动化治理，要求如下：
•	包名：继续遵循 2.4 的命名规则 @huaiye/plugin-xxxx；插件编码不替代包名。
•	package.json：必须写入 huaiye.pluginCode 字段（强制），并建议同步写入 huaiye.mgmtCategory、huaiye.useCategory、huaiye.owner、huaiye.lifecycle 等治理字段。
•	keywords：必须与前端PluginManager.tsx中keyWordlists 中某项完全一致。
•	治理清单：建议在仓库维护，使用脚本对编码进行检查和生成清单
文件样例
# governance/plugins.registry.yml
schemaVersion: 1
generatedAt: "2025-12-17T18:00:00Z"

plugins:
  - pluginCode: "HY-AIC-DOC-PDF-001"
    packageName: "@huaiye/plugin-pdf-viewer-ocr"
    version: "1.4.0"
    owner: "AIC Platform"
    lifecycle: "ACTIVE"

  - pluginCode: "HY-STR-VID-PLY-001"
    packageName: "@huaiye/plugin-video-player"
    version: "2.1.3"
    owner: "Streaming"
    lifecycle: "ACTIVE"
样例脚本，在仓库根 package.json 增加
{
  "scripts": {
    "gen:plugin-registry": "node scripts/gen-plugin-registry.mjs",
    "check:plugin-registry": "node scripts/gen-plugin-registry.mjs && git diff --exit-code governance/plugins.registry.yml"
  }
}

2.3.2.4 生命周期与编码变更规则
生命周期状态建议采用：PLANNED（计划）、DEV（开发中）、ACTIVE（可用）、DEPRECATED（废弃）、RETIRED（下线）。
编码变更规则：
•	版本升级不更换 Plugin Code；编码用于标识“插件产品”，版本用于标识“交付迭代”。
•	拆分：原插件编码置为 DEPRECATED，新插件分配新编码，并在治理清单中记录 replacedBy/replaces 关系。
•	合并：保留一个主编码，其余编码置为 DEPRECATED，并在治理清单中记录 mergedInto 关系。
•	重命名包名（package name）不影响 Plugin Code，但必须在治理清单与元数据中同步更新映射。
3. 插件包结构与工程约定
3.1 目录结构（推荐）
建议采用 monorepo 结构，并按以下目录组织（可按实际仓库约束微调）：
路径	说明
packages/plugins/@huaiye/plugin-xxx/	插件根目录
packages/plugins/@huaiye/plugin-xxx/package.json	插件元数据与分组关键字
packages/plugins/@huaiye/plugin-xxx/client/	前端代码（UI、区块、设置页等）
packages/plugins/@huaiye/plugin-xxx/server/	后端代码（API、服务、事件、数据模型等）
packages/plugins/@huaiye/plugin-xxx/README.md	使用说明、配置、权限、授权说明
packages/plugins/@huaiye/plugin-xxx/i18n/	多语言资源（zh-CN、en-US 等）
packages/plugins/@huaiye/plugin-xxx/tests/	单元/集成测试

3.2 package.json 元数据规范（强制/建议）
为便于治理、授权与自动化交付，插件元数据需满足以下要求：
字段	级别	说明	示例
name	强制	插件包名（符合命名规则）	@huaiye/plugin-pdf-viewer-ocr
displayName	强制	插件显示包名（符合规则）	PDF预览，PDF OCR
version	强制	插件语义化版本	2.0.0-alpha.45
description	强制	一句话说明，包含中英文	Provides PDF Viewer Block, supports OCR
提供PDF预览区块，支持OCR功能
keywords	强制	插件管理分类	["Doc", "Blocks"]
huaiye	强制	插件编码	{
    "pluginCode": "HY-<MGMT>-<USE>-<FUNC>-<SEQ>",
    "mgmtCategory": "<MGMT>",
    "useCategories": "<USE>",
    "func": "<FUNC>",
    "owner": "姓名/团队",
    "lifecycle": "PLANNED|DEV|ACTIVE|DEPRECATED|RETIRED"
}

 
4. 开发规范（核心约束）
4.1 配置与可观测性
•	所有可配置项必须集中管理：默认值、配置项说明、运行时校验（schema）必须齐全。
•	必须提供关键日志：启用/禁用、授权校验失败、外部依赖调用失败、关键业务事件。
•	必须提供健康检查/探针（如适用）：外部服务连通性、关键依赖状态。
4.2 国际化（i18n）
•	所有 UI 文案不得硬编码；必须通过语言包键值管理。
•	新增分组或菜单项需同步补齐 zh-CN.json（以及项目约定的其他语言）。
•	README 必须至少提供中文版本，配置项与权限项需可复制粘贴。
4.3 安全基线
•	所有对外 API 必须鉴权与权限校验（即使是管理后台）。
•	敏感配置（密钥、token）不得写入代码库；必须通过安全配置中心/环境变量注入。
•	外部输入必须校验（避免注入、路径穿越、SSRF 等常见风险）。
5. 使用与运维规范
5.1 安装/升级/回滚
1.	安装前检查：宿主版本、依赖版本、授权状态（如需要）、外部依赖可用性。
2.	安装方式：统一通过插件管理页面或标准化脚本安装，禁止手工拷贝产物绕过登记。
3.	升级策略：遵循语义化版本规范（SemVer）；升级前导出配置与关键数据；灰度验证通过后全量发布。
4.	回滚策略：必须保留可回滚版本的构建产物与变更脚本；回滚后需校验数据一致性。
5.2 启用/禁用与影响评估
•	启用插件前必须完成：配置完善、权限配置、授权通过（如需要）、健康检查通过。
•	禁用插件必须明确影响范围：页面、任务、数据模型、外部连接；并保留审计记录。
6. 授权规范（License/Entitlement）
待完善
7. 交付与发布规范
7.1 版本管理（SemVer）
•	版本号形如：MAJOR.MINOR.PATCH（例如：2.1.4）
MAJOR（主版本号）：当你做了不兼容的 API 修改时递增。
MINOR（次版本号）：当你做了向下兼容的功能新增时递增。
PATCH（修订号）：当你做了向下兼容的问题修复时递增。
此外，SemVer 还支持预发布版本（如 1.0.0-alpha.1）和构建元数据（如 1.0.0+build.20251215）。
•	每次发布必须产出：变更日志（Changelog）、兼容性声明、升级/回滚说明。
7.2 发布包与制品管理
•	发布制品需可追溯：构建号、Git commit、依赖锁定信息（lockfile）。
•	禁止使用未经登记的第三方源制品；制品库统一管理。
8. 插件验收清单（可直接用于提测/上线前）
类别	检查项	通过标准
分组	keywords 命中分组关键字	插件在管理页面/使用入口分组正确
命名	包名符合 @huaiye/plugin-xxxx	无临时命名/无歧义
文档	README 完整	含安装、配置、使用、故障排查
权限	最小权限原则	菜单/路由/API 均有校验
授权	licenseRequired 插件受控	无授权不可启用；运行时二次校验
安全	输入校验与密钥管理	无明文密钥；关键接口安全扫描通过
可观测	日志与告警	关键失败可定位；必要时可告警
兼容	宿主版本兼容声明	在目标版本环境验证通过
回滚	回滚方案可执行	回滚后核心功能正常

